/* Original
USE WAREHOUSE COMPUTE_WH;
USE DATABASE DS2508;
USE SCHEMA EPX8HH;

--Somewhere in my flow I lost all of yahoo symbols. I checked the normalizer functions and that worked like normal so not sure where it went wrong yet;

WITH tbls AS (
    SELECT TABLE_NAME
    FROM DS2508.INFORMATION_SCHEMA.TABLES
    WHERE TABLE_SCHEMA = 'EPX8HH'
      AND TABLE_TYPE = 'BASE TABLE'
      AND TABLE_NAME ILIKE 'WSJ%'
)
SELECT
    'SELECT SYMBOL FROM ' || TABLE_NAME
FROM tbls;


CREATE OR REPLACE TABLE UNIQUE_SYMS AS
SELECT DISTINCT SYMBOL
FROM (
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251017_093200
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251013_160143
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251013_123022
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251014_093123
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251015_093114
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251017_160116
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251013_093113
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251007_034910
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251016_093124
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251017_124348
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251015_160125
    UNION ALL
    SELECT SYMBOL FROM EPX8HH.WSJGAINERS_20251016_123016
);
*/
--For DBT
{{ config(materialized='table') }}

SELECT DISTINCT SYMBOL
FROM (
    SELECT SYMBOL FROM WSJGAINERS_20251017_093200
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251013_160143
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251013_123022
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251014_093123
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251015_093114
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251017_160116
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251013_093113
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251007_034910
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251016_093124
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251017_124348
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251015_160125
    UNION ALL
    SELECT SYMBOL FROM WSJGAINERS_20251016_123016
)
